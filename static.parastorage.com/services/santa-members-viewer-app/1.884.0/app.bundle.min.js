! function(e, t) {
    "object" == typeof exports && "object" == typeof module ? module.exports = t() : "function" == typeof define && define.amd ? define("santa-members-viewer-script", [], t) : "object" == typeof exports ? exports["santa-members-viewer-script"] = t() : e["santa-members-viewer-script"] = t()
}("undefined" != typeof self ? self : this, (function() {
    return function() {
        var e = {
                539: function(e, t) {
                    "use strict";
                    t.dn = "14bcded7-0066-7c35-14d7-466cb3f09103", t.sV = "140603ad-af8d-84a5-2c80-a0f60cb47351", t.tt = "14724f35-6794-cd1a-0244-25fd138f9242", t.qq = "148c2287-c669-d849-d153-463c7486a694";
                    var r = {}
                },
                613: function(e) {
                    function t(e, t, r, n, i, o, u) {
                        try {
                            var s = e[o](u),
                                a = s.value
                        } catch (e) {
                            return void r(e)
                        }
                        s.done ? t(a) : Promise.resolve(a).then(n, i)
                    }
                    e.exports = function(e) {
                        return function() {
                            var r = this,
                                n = arguments;
                            return new Promise((function(i, o) {
                                var u = e.apply(r, n);

                                function s(e) {
                                    t(u, i, o, s, a, "next", e)
                                }

                                function a(e) {
                                    t(u, i, o, s, a, "throw", e)
                                }
                                s(void 0)
                            }))
                        }
                    }, e.exports.default = e.exports, e.exports.__esModule = !0
                },
                945: function(e) {
                    e.exports = function(e, t, r) {
                        return t in e ? Object.defineProperty(e, t, {
                            value: r,
                            enumerable: !0,
                            configurable: !0,
                            writable: !0
                        }) : e[t] = r, e
                    }, e.exports.default = e.exports, e.exports.__esModule = !0
                },
                973: function(e) {
                    function t() {
                        return e.exports = t = Object.assign || function(e) {
                            for (var t = 1; t < arguments.length; t++) {
                                var r = arguments[t];
                                for (var n in r) Object.prototype.hasOwnProperty.call(r, n) && (e[n] = r[n])
                            }
                            return e
                        }, e.exports.default = e.exports, e.exports.__esModule = !0, t.apply(this, arguments)
                    }
                    e.exports = t, e.exports.default = e.exports, e.exports.__esModule = !0
                },
                803: function(e, t, r) {
                    e.exports = r(248)
                },
                248: function(e) {
                    var t = function(e) {
                        "use strict";
                        var t, r = Object.prototype,
                            n = r.hasOwnProperty,
                            i = "function" == typeof Symbol ? Symbol : {},
                            o = i.iterator || "@@iterator",
                            u = i.asyncIterator || "@@asyncIterator",
                            s = i.toStringTag || "@@toStringTag";

                        function a(e, t, r) {
                            return Object.defineProperty(e, t, {
                                value: r,
                                enumerable: !0,
                                configurable: !0,
                                writable: !0
                            }), e[t]
                        }
                        try {
                            a({}, "")
                        } catch (e) {
                            a = function(e, t, r) {
                                return e[t] = r
                            }
                        }

                        function c(e, t, r, n) {
                            var i = t && t.prototype instanceof g ? t : g,
                                o = Object.create(i.prototype),
                                u = new S(n || []);
                            return o._invoke = function(e, t, r) {
                                var n = f;
                                return function(i, o) {
                                    if (n === d) throw new Error("Generator is already running");
                                    if (n === m) {
                                        if ("throw" === i) throw o;
                                        return N()
                                    }
                                    for (r.method = i, r.arg = o;;) {
                                        var u = r.delegate;
                                        if (u) {
                                            var s = I(u, r);
                                            if (s) {
                                                if (s === v) continue;
                                                return s
                                            }
                                        }
                                        if ("next" === r.method) r.sent = r._sent = r.arg;
                                        else if ("throw" === r.method) {
                                            if (n === f) throw n = m, r.arg;
                                            r.dispatchException(r.arg)
                                        } else "return" === r.method && r.abrupt("return", r.arg);
                                        n = d;
                                        var a = p(e, t, r);
                                        if ("normal" === a.type) {
                                            if (n = r.done ? m : l, a.arg === v) continue;
                                            return {
                                                value: a.arg,
                                                done: r.done
                                            }
                                        }
                                        "throw" === a.type && (n = m, r.method = "throw", r.arg = a.arg)
                                    }
                                }
                            }(e, r, u), o
                        }

                        function p(e, t, r) {
                            try {
                                return {
                                    type: "normal",
                                    arg: e.call(t, r)
                                }
                            } catch (e) {
                                return {
                                    type: "throw",
                                    arg: e
                                }
                            }
                        }
                        e.wrap = c;
                        var f = "suspendedStart",
                            l = "suspendedYield",
                            d = "executing",
                            m = "completed",
                            v = {};

                        function g() {}

                        function h() {}

                        function b() {}
                        var w = {};
                        a(w, o, (function() {
                            return this
                        }));
                        var x = Object.getPrototypeOf,
                            y = x && x(x(k([])));
                        y && y !== r && n.call(y, o) && (w = y);
                        var C = b.prototype = g.prototype = Object.create(w);

                        function R(e) {
                            ["next", "throw", "return"].forEach((function(t) {
                                a(e, t, (function(e) {
                                    return this._invoke(t, e)
                                }))
                            }))
                        }

                        function P(e, t) {
                            function r(i, o, u, s) {
                                var a = p(e[i], e, o);
                                if ("throw" !== a.type) {
                                    var c = a.arg,
                                        f = c.value;
                                    return f && "object" == typeof f && n.call(f, "__await") ? t.resolve(f.__await).then((function(e) {
                                        r("next", e, u, s)
                                    }), (function(e) {
                                        r("throw", e, u, s)
                                    })) : t.resolve(f).then((function(e) {
                                        c.value = e, u(c)
                                    }), (function(e) {
                                        return r("throw", e, u, s)
                                    }))
                                }
                                s(a.arg)
                            }
                            var i;
                            this._invoke = function(e, n) {
                                function o() {
                                    return new t((function(t, i) {
                                        r(e, n, t, i)
                                    }))
                                }
                                return i = i ? i.then(o, o) : o()
                            }
                        }

                        function I(e, r) {
                            var n = e.iterator[r.method];
                            if (n === t) {
                                if (r.delegate = null, "throw" === r.method) {
                                    if (e.iterator.return && (r.method = "return", r.arg = t, I(e, r), "throw" === r.method)) return v;
                                    r.method = "throw", r.arg = new TypeError("The iterator does not provide a 'throw' method")
                                }
                                return v
                            }
                            var i = p(n, e.iterator, r.arg);
                            if ("throw" === i.type) return r.method = "throw", r.arg = i.arg, r.delegate = null, v;
                            var o = i.arg;
                            return o ? o.done ? (r[e.resultName] = o.value, r.next = e.nextLoc, "return" !== r.method && (r.method = "next", r.arg = t), r.delegate = null, v) : o : (r.method = "throw", r.arg = new TypeError("iterator result is not an object"), r.delegate = null, v)
                        }

                        function U(e) {
                            var t = {
                                tryLoc: e[0]
                            };
                            1 in e && (t.catchLoc = e[1]), 2 in e && (t.finallyLoc = e[2], t.afterLoc = e[3]), this.tryEntries.push(t)
                        }

                        function M(e) {
                            var t = e.completion || {};
                            t.type = "normal", delete t.arg, e.completion = t
                        }

                        function S(e) {
                            this.tryEntries = [{
                                tryLoc: "root"
                            }], e.forEach(U, this), this.reset(!0)
                        }

                        function k(e) {
                            if (e) {
                                var r = e[o];
                                if (r) return r.call(e);
                                if ("function" == typeof e.next) return e;
                                if (!isNaN(e.length)) {
                                    var i = -1,
                                        u = function r() {
                                            for (; ++i < e.length;)
                                                if (n.call(e, i)) return r.value = e[i], r.done = !1, r;
                                            return r.value = t, r.done = !0, r
                                        };
                                    return u.next = u
                                }
                            }
                            return {
                                next: N
                            }
                        }

                        function N() {
                            return {
                                value: t,
                                done: !0
                            }
                        }
                        return h.prototype = b, a(C, "constructor", b), a(b, "constructor", h), h.displayName = a(b, s, "GeneratorFunction"), e.isGeneratorFunction = function(e) {
                            var t = "function" == typeof e && e.constructor;
                            return !!t && (t === h || "GeneratorFunction" === (t.displayName || t.name))
                        }, e.mark = function(e) {
                            return Object.setPrototypeOf ? Object.setPrototypeOf(e, b) : (e.__proto__ = b, a(e, s, "GeneratorFunction")), e.prototype = Object.create(C), e
                        }, e.awrap = function(e) {
                            return {
                                __await: e
                            }
                        }, R(P.prototype), a(P.prototype, u, (function() {
                            return this
                        })), e.AsyncIterator = P, e.async = function(t, r, n, i, o) {
                            void 0 === o && (o = Promise);
                            var u = new P(c(t, r, n, i), o);
                            return e.isGeneratorFunction(r) ? u : u.next().then((function(e) {
                                return e.done ? e.value : u.next()
                            }))
                        }, R(C), a(C, s, "Generator"), a(C, o, (function() {
                            return this
                        })), a(C, "toString", (function() {
                            return "[object Generator]"
                        })), e.keys = function(e) {
                            var t = [];
                            for (var r in e) t.push(r);
                            return t.reverse(),
                                function r() {
                                    for (; t.length;) {
                                        var n = t.pop();
                                        if (n in e) return r.value = n, r.done = !1, r
                                    }
                                    return r.done = !0, r
                                }
                        }, e.values = k, S.prototype = {
                            constructor: S,
                            reset: function(e) {
                                if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = "next", this.arg = t, this.tryEntries.forEach(M), !e)
                                    for (var r in this) "t" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t)
                            },
                            stop: function() {
                                this.done = !0;
                                var e = this.tryEntries[0].completion;
                                if ("throw" === e.type) throw e.arg;
                                return this.rval
                            },
                            dispatchException: function(e) {
                                if (this.done) throw e;
                                var r = this;

                                function i(n, i) {
                                    return s.type = "throw", s.arg = e, r.next = n, i && (r.method = "next", r.arg = t), !!i
                                }
                                for (var o = this.tryEntries.length - 1; o >= 0; --o) {
                                    var u = this.tryEntries[o],
                                        s = u.completion;
                                    if ("root" === u.tryLoc) return i("end");
                                    if (u.tryLoc <= this.prev) {
                                        var a = n.call(u, "catchLoc"),
                                            c = n.call(u, "finallyLoc");
                                        if (a && c) {
                                            if (this.prev < u.catchLoc) return i(u.catchLoc, !0);
                                            if (this.prev < u.finallyLoc) return i(u.finallyLoc)
                                        } else if (a) {
                                            if (this.prev < u.catchLoc) return i(u.catchLoc, !0)
                                        } else {
                                            if (!c) throw new Error("try statement without catch or finally");
                                            if (this.prev < u.finallyLoc) return i(u.finallyLoc)
                                        }
                                    }
                                }
                            },
                            abrupt: function(e, t) {
                                for (var r = this.tryEntries.length - 1; r >= 0; --r) {
                                    var i = this.tryEntries[r];
                                    if (i.tryLoc <= this.prev && n.call(i, "finallyLoc") && this.prev < i.finallyLoc) {
                                        var o = i;
                                        break
                                    }
                                }
                                o && ("break" === e || "continue" === e) && o.tryLoc <= t && t <= o.finallyLoc && (o = null);
                                var u = o ? o.completion : {};
                                return u.type = e, u.arg = t, o ? (this.method = "next", this.next = o.finallyLoc, v) : this.complete(u)
                            },
                            complete: function(e, t) {
                                if ("throw" === e.type) throw e.arg;
                                return "break" === e.type || "continue" === e.type ? this.next = e.arg : "return" === e.type ? (this.rval = this.arg = e.arg, this.method = "return", this.next = "end") : "normal" === e.type && t && (this.next = t), v
                            },
                            finish: function(e) {
                                for (var t = this.tryEntries.length - 1; t >= 0; --t) {
                                    var r = this.tryEntries[t];
                                    if (r.finallyLoc === e) return this.complete(r.completion, r.afterLoc), M(r), v
                                }
                            },
                            catch: function(e) {
                                for (var t = this.tryEntries.length - 1; t >= 0; --t) {
                                    var r = this.tryEntries[t];
                                    if (r.tryLoc === e) {
                                        var n = r.completion;
                                        if ("throw" === n.type) {
                                            var i = n.arg;
                                            M(r)
                                        }
                                        return i
                                    }
                                }
                                throw new Error("illegal catch attempt")
                            },
                            delegateYield: function(e, r, n) {
                                return this.delegate = {
                                    iterator: k(e),
                                    resultName: r,
                                    nextLoc: n
                                }, "next" === this.method && (this.arg = t), v
                            }
                        }, e
                    }(e.exports);
                    try {
                        regeneratorRuntime = t
                    } catch (e) {
                        "object" == typeof globalThis ? globalThis.regeneratorRuntime = t : Function("r", "regeneratorRuntime = r")(t)
                    }
                }
            },
            t = {};

        function r(n) {
            var i = t[n];
            if (void 0 !== i) return i.exports;
            var o = t[n] = {
                exports: {}
            };
            return e[n](o, o.exports, r), o.exports
        }
        r.n = function(e) {
            var t = e && e.__esModule ? function() {
                return e.default
            } : function() {
                return e
            };
            return r.d(t, {
                a: t
            }), t
        }, r.d = function(e, t) {
            for (var n in t) r.o(t, n) && !r.o(e, n) && Object.defineProperty(e, n, {
                enumerable: !0,
                get: t[n]
            })
        }, r.o = function(e, t) {
            return Object.prototype.hasOwnProperty.call(e, t)
        }, r.r = function(e) {
            "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, {
                value: "Module"
            }), Object.defineProperty(e, "__esModule", {
                value: !0
            })
        };
        var n = {};
        return function() {
            "use strict";
            r.r(n), r.d(n, {
                createControllers: function() {
                    return pe
                },
                exports: function() {
                    return fe
                },
                initAppForPage: function() {
                    return ce
                }
            });
            var e = r(973),
                t = r.n(e),
                i = r(613),
                o = r.n(i),
                u = r(803),
                s = r.n(u);

            function a(e) {
                return e && e[0] ? Object.keys(e[0]).includes("isVisible") ? function(e) {
                    return e.map((function(e) {
                        return {
                            link: e.link,
                            isVisibleInMenuBar: e.isVisible,
                            isVisibleInMobileMenuBar: e.isVisibleMobile,
                            visibleForRoles: e.visibleForRoles
                        }
                    }))
                }(e) : function(e) {
                    return e.map((function(e) {
                        return {
                            link: e.l,
                            isVisibleInMenuBar: !e.hmb,
                            isVisibleInMobileMenuBar: !e.hmmb,
                            visibleForRoles: e.vfr || []
                        }
                    }))
                }(e) : []
            }
            var c, p, f = r(539),
                l = "{userName}",
                d = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-5][0-9a-f]{3}-[089ab][0-9a-f]{3}-[0-9a-f]{12}$/i,
                m = [f.dn, f.tt, f.qq, f.sV, "14ebe801-d78a-daa9-c9e5-0286a891e46f", "14dbef06-cc42-5583-32a7-3abd44da4908", "1537b24e-29d1-6d8f-b8e1-d6860f2f70b9", "476dc2dd-e16e-43b0-a0aa-1a486c78fbe2"],
                v = "specs.membersArea.EnableMemberPagePermissions",
                g = "@members_menu",
                h = "@members-menu";
            var b, w = function(e, t) {
                return function() {
                    try {
                        ! function(e) {
                            try {
                                p.interactionStarted(e)
                            } catch (e) {
                                var t = "Failed to start fedops interaction, reason: " + e;
                                c && c.captureException(t)
                            }
                        }(e);
                        var r = t();
                        return function(e) {
                            try {
                                p.interactionEnded(e)
                            } catch (e) {
                                var t = "Failed to end fedops interaction, reason: " + e;
                                c && c.captureException(t)
                            }
                        }(e), r
                    } catch (e) {
                        throw console.error(e), c && c.captureException(e), e
                    }
                }
            };

            function x(e, r) {
                var n;
                void 0 === r && (r = {}), null != (n = c) && n.captureMessage && c.captureMessage(e, t()({
                    level: "info"
                }, r))
            }

            function y(e, r) {
                var n;
                void 0 === r && (r = {}), null != (n = c) && n.captureMessage && c.captureMessage(e, t()({
                    level: "error"
                }, r))
            }

            function C() {
                return b
            }
            var R = function() {
                    function e(e) {
                        this.httpClient = e
                    }
                    var t = e.prototype;
                    return t.get = function() {
                        var e = o()(s().mark((function e(t) {
                            var r;
                            return s().wrap((function(e) {
                                for (;;) switch (e.prev = e.next) {
                                    case 0:
                                        return e.prev = 0, e.next = 3, this.httpClient.get(t);
                                    case 3:
                                        return r = e.sent, e.abrupt("return", r.data);
                                    case 7:
                                        return e.prev = 7, e.t0 = e.catch(0), console.log("error fetching data", e.t0.message), e.abrupt("return", {});
                                    case 11:
                                    case "end":
                                        return e.stop()
                                }
                            }), e, this, [
                                [0, 7]
                            ])
                        })));
                        return function(t) {
                            return e.apply(this, arguments)
                        }
                    }(), t.post = function() {
                        var e = o()(s().mark((function e(t, r) {
                            var n;
                            return s().wrap((function(e) {
                                for (;;) switch (e.prev = e.next) {
                                    case 0:
                                        return e.prev = 0, e.next = 3, this.httpClient.post(t, r);
                                    case 3:
                                        return n = e.sent, e.abrupt("return", n.data);
                                    case 7:
                                        return e.prev = 7, e.t0 = e.catch(0), console.log("error posting data", e.t0.message), e.abrupt("return", {});
                                    case 11:
                                    case "end":
                                        return e.stop()
                                }
                            }), e, this, [
                                [0, 7]
                            ])
                        })));
                        return function(t, r) {
                            return e.apply(this, arguments)
                        }
                    }(), e
                }(),
                P = function(e) {
                    var t, r, n = null == (t = e.essentials) || null == (r = t.appEssentials) ? void 0 : r.httpClient;
                    if (!n) throw new Error("HttpClient is not defined in the config");
                    return n
                },
                I = "current-user-slug",
                U = "current-user-id";

            function M(e) {
                var t, r, n;

                function i() {
                    return (i = o()(s().mark((function e(t, r, n) {
                        var i, o;
                        return s().wrap((function(e) {
                            for (;;) switch (e.prev = e.next) {
                                case 0:
                                    return i = new R(r), e.next = 3, i.get("/_api/santa-members-server/temporary/members/" + t + "/numbers");
                                case 3:
                                    return o = e.sent, e.abrupt("return", n(o));
                                case 5:
                                case "end":
                                    return e.stop()
                            }
                        }), e)
                    })))).apply(this, arguments)
                }

                function u() {
                    return (u = o()(s().mark((function e(t, r, n) {
                        var i, o, u;
                        return s().wrap((function(e) {
                            for (;;) switch (e.prev = e.next) {
                                case 0:
                                    return i = [], t && i.push(t), r && i.push(r), o = new R(n), e.next = 6, o.post("/_api/santa-members-server/temporary/members/roles", i);
                                case 6:
                                    return u = e.sent, e.abrupt("return", u);
                                case 8:
                                case "end":
                                    return e.stop()
                            }
                        }), e)
                    })))).apply(this, arguments)
                }

                function a() {
                    return (a = o()(s().mark((function e(t) {
                        var r, n, i, o;
                        return s().wrap((function(e) {
                            for (;;) switch (e.prev = e.next) {
                                case 0:
                                    return i = new R(t), e.next = 3, i.get("/_api/members/v1/members/my");
                                case 3:
                                    return o = e.sent, e.abrupt("return", null == (r = o.member) || null == (n = r.profile) ? void 0 : n.slug);
                                case 5:
                                case "end":
                                    return e.stop()
                            }
                        }), e)
                    })))).apply(this, arguments)
                }
                return {
                    getCurrentUser: function() {
                        var e;
                        return null != (e = r) ? e : {}
                    },
                    setCurrentUser: function(t, n) {
                        return Promise.resolve().then((function() {
                            return function(t, r) {
                                var n = C(),
                                    i = n.getItem(I),
                                    o = n.getItem(U);
                                if (i && o === t.id) return i;
                                o && o === t.id || n.setItem(U, t.id);
                                if (t.loggedIn && t.getSlug) return "Site" === e.window.viewMode ? function(e) {
                                    return a.apply(this, arguments)
                                }(r).then((function(e) {
                                    var r = e || t.id;
                                    return n.setItem(I, r), r
                                })).catch((function() {
                                    return y("Error while fetching current user slug", {
                                        userDataId: t.id
                                    })
                                })) : t.getSlug();
                                return t.id
                            }(t, n)
                        })).then((function(e) {
                            r = {
                                id: t.id,
                                loggedIn: t.loggedIn,
                                slug: e
                            }
                        }))
                    },
                    getViewedUser: function() {
                        var e;
                        return null != (e = t) ? e : {}
                    },
                    setViewedUser: function(e) {
                        e && (t = e)
                    },
                    fetchRoles: function(e, t, r) {
                        return u.apply(this, arguments)
                    },
                    getRoles: function() {
                        var e;
                        return null != (e = n) ? e : {}
                    },
                    setRoles: function(e) {
                        n = e
                    },
                    fetchMenuCounters: function(e, t) {
                        return e && !1 !== e.loggedIn ? new Promise((function(r, n) {
                            var o = e && e.id;
                            o && t ? function(e, t, r) {
                                i.apply(this, arguments)
                            }(o, t, (function(e) {
                                r(e)
                            })) : n(new Error("No user to get menu counters by"))
                        })) : Promise.resolve({})
                    },
                    replaceUserPatternWithSlug: function(e, t) {
                        return e.replace(l, t.slug).replace(encodeURI(l), t.slug)
                    }
                }
            }
            var S;

            function k(e) {
                var t = e.location,
                    r = t.prefix,
                    n = t.path,
                    i = t.query,
                    o = Object.keys(i).length > 0 ? "?" + function(e) {
                        return Object.keys(e).map((function(t) {
                            return t + "=" + e[t]
                        })).join("&")
                    }(i) : "";
                return "/" + r + "/" + n.join("/") + o
            }
            var N = function() {
                return S || []
            };

            function O(e) {
                var t = e.menuItem,
                    r = e.publicRouterConfig,
                    n = void 0 === r ? {} : r,
                    i = e.privateRouterConfig,
                    o = void 0 === i ? {} : i,
                    u = e.viewedUser,
                    s = e.shouldLog,
                    a = void 0 === s || s,
                    c = t.link;
                u && 0 === c.indexOf("/" + u.slug + "/") && (c = c.replace("/" + u.slug + "/", "/{userName}/"));
                var p = c.split("/"),
                    f = p.indexOf(l),
                    d = f > -1 ? "/" + p.splice(f, p.length).join("/") : "/" + p[p.length - 1],
                    m = n.patterns || {},
                    v = o.patterns || {},
                    g = m[d] || v[d];
                if (!g && a) {
                    var h = {
                        menuItem: t,
                        publicRouterConfig: n,
                        privateRouterConfig: o,
                        viewedUser: u
                    };
                    x("Could not find the pattern for menu item in router configs - probably an invalid (or custom) menu item", {
                        tags: {
                            menuItemLink: t.link
                        },
                        extra: {
                            data: JSON.stringify(h)
                        }
                    })
                }
                return g
            }

            function E(e) {
                var t = e.menuItems,
                    r = e.publicRouterPrefix,
                    n = t.filter((function(e) {
                        return !!e.link || e.items && e.items.length > 0
                    }));
                return n.forEach((function(e) {
                    if (e.link && 0 === e.link.indexOf("undefined/{userName}")) {
                        var t = e.link.split("/");
                        e.link = "/" + r + "/" + "{userName}/" + t[2]
                    }
                })), n.forEach((function(e) {
                    if (e.link && (4 === e.link.split("/").length && -1 === e.link.indexOf(l))) {
                        var t = e.link.split("/");
                        e.link = "/" + t[1] + "/" + "{userName}/" + t[3]
                    }
                })), n
            }

            function A(e) {
                var t = e.slug,
                    r = e.options,
                    n = function(e, t) {
                        if (!t) return e;
                        var r = e.split("/").slice(1);
                        return r[1].match(d) ? (r[1] = t, "/" + r.join("/")) : e
                    }(k(e.wixCodeApi).split("?")[0], t),
                    i = r.find((function(e) {
                        return e.link === n
                    }));
                return i ? i.value : null
            }

            function L(e) {
                var t = e.menu,
                    r = e.options,
                    n = e.viewedUser,
                    i = e.wixCodeApi;
                if (!1 === t.autoNavigation) {
                    var o = (n || {}).slug;
                    t.value = A({
                            slug: o,
                            options: r,
                            wixCodeApi: i
                        }),
                        function(e) {
                            var t = e.menu,
                                r = e.options,
                                n = e.wixCodeApi;
                            null == t.onChange || t.onChange((function(e) {
                                var i, o = e.target,
                                    u = o.value,
                                    s = (r.find((function(e) {
                                        return e.value === u
                                    })) || {}).link;
                                s ? n.location.to(s) : y("Menu navigation request ignored: ", {
                                    menu: t,
                                    target: o,
                                    options: r,
                                    newLink: s,
                                    api: !(null == n || null == (i = n.location) || !i.to)
                                })
                            }))
                        }({
                            menu: t,
                            options: r,
                            wixCodeApi: i
                        })
                }
            }

            function D(e) {
                var t = e.menuItems,
                    r = e.parsedRoutersConfigs,
                    n = e.userRoles,
                    i = e.viewedUser,
                    o = e.appsCounters,
                    u = null == r ? void 0 : r.find((function(e) {
                        return "public" === e.type
                    })),
                    s = null == r ? void 0 : r.find((function(e) {
                        return "private" === e.type
                    }));
                return function(e) {
                    var t = e.menuItems,
                        r = e.viewedUser;
                    return t.map((function(e) {
                        return e.link && e.link.indexOf(l) > -1 && (e.link = e.link.replace(l, r.slug)), e
                    }))
                }({
                    menuItems: function(e) {
                        var t, r = e.menuItems,
                            n = e.appsCounters,
                            i = e.publicRouterConfig,
                            o = e.privateRouterConfig,
                            u = e.viewedUser;
                        return r.forEach((function(e) {
                            e.displayCount = null
                        })), null != n && null != (t = n.apps) && t.length ? (n.apps.forEach((function(e) {
                            r.forEach((function(t) {
                                if (t.link) {
                                    var r = O({
                                        menuItem: t,
                                        publicRouterConfig: i,
                                        privateRouterConfig: o,
                                        viewedUser: u
                                    });
                                    if (r && r.appData.appDefinitionId === e.appDefId) {
                                        var n = r.appData.numbers && r.appData.numbers.key,
                                            s = e.numbers && n && e.numbers[n];
                                        s && (t.displayCount = s.count)
                                    }
                                }
                            }))
                        })), r) : r
                    }({
                        menuItems: function(e) {
                            var t = e.menuItems,
                                r = e.publicRouterConfig,
                                n = e.privateRouterConfig,
                                i = e.userRoles,
                                o = void 0 === i ? [] : i,
                                u = e.viewedUser;
                            return t.filter((function(e) {
                                if (!e.link) return !0;
                                var t = O({
                                    menuItem: e,
                                    publicRouterConfig: r,
                                    privateRouterConfig: n,
                                    viewedUser: u
                                });
                                if (!t || !t.appData || !t.appData.visibleForRoles || 0 === t.appData.visibleForRoles.length) return !0;
                                var i = t.appData.visibleForRoles;
                                return !!(void 0 === i ? [] : i).some((function(e) {
                                    return o.indexOf(e) > -1
                                }))
                            }))
                        }({
                            menuItems: t,
                            publicRouterConfig: u,
                            privateRouterConfig: s,
                            userRoles: n,
                            viewedUser: i
                        }),
                        appsCounters: o,
                        publicRouterConfig: u,
                        privateRouterConfig: s,
                        viewedUser: i
                    }),
                    viewedUser: i
                })
            }

            function j(e) {
                var t = e.menuItems,
                    r = e.parsedRoutersConfigs,
                    n = e.viewedUser,
                    i = e.permittedPagesMap,
                    o = e.experiments;
                if (o && o.enabled(v)) {
                    var u = null == r ? void 0 : r.find((function(e) {
                            return "public" === e.type
                        })),
                        s = null == r ? void 0 : r.find((function(e) {
                            return "private" === e.type
                        }));
                    return t.filter((function(e) {
                        var t, r = O({
                            menuItem: e,
                            publicRouterConfig: u,
                            privateRouterConfig: s,
                            viewedUser: n
                        });
                        return !r || (null == (t = i[r.page]) || t)
                    }))
                }
                return t
            }

            function F(e) {
                var t = e.menuItems,
                    r = e.parsedRoutersConfigs,
                    n = void 0 === r ? [] : r,
                    i = e.viewedUserRoles,
                    o = e.viewedUser,
                    u = e.currentUser,
                    s = e.appsCounters,
                    a = e.parsedConfigItems,
                    c = e.publicRouterPrefix,
                    p = e.permittedPagesMap,
                    f = e.experiments,
                    l = !o.id && u ? u : o,
                    d = D({
                        menuItems: j({
                            menuItems: function(e) {
                                var t = e.menuItems,
                                    r = e.currentUser,
                                    n = e.viewedUser,
                                    i = e.parsedRoutersConfigs,
                                    o = void 0 === i ? [] : i;
                                if (!n.id) return t;
                                if (r && r.id === n.id) return t;
                                var u = o.find((function(e) {
                                    return "private" === e.type
                                }));
                                return t.filter((function(e) {
                                    return !e.link || !O({
                                        menuItem: e,
                                        viewedUser: n,
                                        privateRouterConfig: u,
                                        shouldLog: !1
                                    })
                                }))
                            }({
                                menuItems: function(e) {
                                    var t = e.menuItems,
                                        r = e.parsedConfigItems;
                                    if (r) return t.filter((function(e) {
                                        var t = (r.find((function(t) {
                                            return t.link === e.link
                                        })) || {}).isVisibleInMenuBar;
                                        return "boolean" != typeof t || t
                                    }))
                                }({
                                    menuItems: E({
                                        menuItems: t,
                                        publicRouterPrefix: c
                                    }),
                                    parsedConfigItems: a
                                }) || [],
                                currentUser: u,
                                viewedUser: o,
                                parsedRoutersConfigs: n
                            }),
                            parsedRoutersConfigs: n,
                            permittedPagesMap: p,
                            viewedUser: o,
                            experiments: f
                        }),
                        parsedRoutersConfigs: n,
                        userRoles: i,
                        viewedUser: l,
                        appsCounters: s
                    });
                return d.forEach((function(e) {
                    e.items && e.items.length > 0 && (e.items = F({
                        menuItems: e.items,
                        parsedRoutersConfigs: n,
                        viewedUserRoles: i,
                        viewedUser: o,
                        currentUser: u,
                        appsCounters: s,
                        parsedConfigItems: a,
                        publicRouterPrefix: c
                    }))
                })), {
                    menuItems: d
                }.menuItems.filter((function(e) {
                    return !!e.link || e.items && e.items.length > 0
                }))
            }

            function _(e) {
                var t = e.menuItems,
                    r = e.parsedRoutersConfigs,
                    n = e.userRoles,
                    i = e.viewedUser,
                    o = e.appsCounters,
                    u = e.publicRouterPrefix,
                    s = e.permittedPagesMap,
                    a = e.experiments;
                return D({
                    menuItems: j({
                        menuItems: E({
                            menuItems: t,
                            publicRouterPrefix: u
                        }),
                        parsedRoutersConfigs: r,
                        permittedPagesMap: s,
                        viewedUser: i,
                        experiments: a
                    }),
                    parsedRoutersConfigs: r,
                    userRoles: n,
                    viewedUser: i,
                    appsCounters: o
                })
            }

            function V(e) {
                var t = e.menu,
                    r = e.parsedRoutersConfigs,
                    n = e.currentUserRoles,
                    i = e.currentUser,
                    o = e.appsCounters,
                    u = e.memoryStorage,
                    s = e.publicRouterPrefix,
                    a = e.permittedPagesMap,
                    c = e.experiments,
                    p = e.isMobile,
                    f = Boolean((null == t ? void 0 : t.accountNavBar) && t.accountNavBar.navBarItems && t.accountNavBar.menuItems && p),
                    l = f ? t.accountNavBar.navBarItems : t.navBarItems || [],
                    d = f ? null == t ? void 0 : t.accountNavBar.menuItems : t.menuItems || [],
                    m = "login-dropdown-menu-initial-items-" + t.id,
                    v = JSON.parse(u.getItem(m));
                if (!v) {
                    var g = JSON.stringify(d);
                    u.setItem(m, g), v = d
                }
                var h = _({
                        menuItems: l,
                        parsedRoutersConfigs: r,
                        userRoles: n,
                        viewedUser: i,
                        appsCounters: o,
                        publicRouterPrefix: s,
                        permittedPagesMap: a,
                        experiments: c
                    }),
                    b = _({
                        menuItems: v,
                        parsedRoutersConfigs: r,
                        userRoles: n,
                        viewedUser: i,
                        appsCounters: o,
                        publicRouterPrefix: s,
                        permittedPagesMap: a,
                        experiments: c
                    });
                f ? (t.accountNavBar.navBarItems = h, t.accountNavBar.menuItems = b) : (t.navBarItems = h, t.menuItems = b)
            }

            function T(e) {
                var t = e.wixCodeApi,
                    r = e.menu,
                    n = e.parsedRoutersConfigs,
                    i = e.viewedUserRoles,
                    o = e.currentUser,
                    u = e.viewedUser,
                    s = e.appsCounters,
                    a = e.parsedConfigItems,
                    c = e.memoryStorage,
                    p = e.publicRouterPrefix,
                    f = e.permittedPagesMap,
                    l = e.experiments,
                    d = e.isMobile && void 0 !== r.options && void 0 === r.items,
                    m = d ? r.options || [] : r.items || [],
                    v = "members-menu-initial-items-" + r.id,
                    g = JSON.parse(c.getItem(v));
                if (!g) {
                    var h = JSON.stringify(m);
                    c.setItem(v, h), g = m
                }
                var b = F({
                    menuItems: g,
                    parsedRoutersConfigs: n,
                    viewedUserRoles: i,
                    currentUser: o,
                    viewedUser: u,
                    appsCounters: s,
                    parsedConfigItems: a,
                    publicRouterPrefix: p,
                    permittedPagesMap: f,
                    experiments: l
                });
                d ? (r.options = b, L({
                    menu: r,
                    options: b,
                    viewedUser: u,
                    wixCodeApi: t
                })) : r.items = b
            }

            function B(e) {
                var t, r = e.$w,
                    n = e.parsedRoutersConfigs,
                    i = void 0 === n ? [] : n,
                    o = e.currentUserRoles,
                    u = e.currentUser,
                    s = e.appsCounters,
                    a = e.memoryStorage,
                    c = e.publicRouterPrefix,
                    p = e.permittedPagesMap,
                    f = void 0 === p ? {} : p,
                    l = e.experiments,
                    d = void 0 === l ? null : l,
                    m = e.isMobile;
                if (u.loggedIn) {
                    var v = r("@members_login"),
                        g = r("@members-login-bar");
                    v.forEach((function(e) {
                        return V({
                            menu: e,
                            parsedRoutersConfigs: i,
                            currentUserRoles: o,
                            currentUser: u,
                            appsCounters: s,
                            memoryStorage: a,
                            publicRouterPrefix: c,
                            permittedPagesMap: f,
                            experiments: d,
                            isMobile: m
                        })
                    })), g.forEach((function(e) {
                        return V({
                            menu: e,
                            parsedRoutersConfigs: i,
                            currentUserRoles: o,
                            currentUser: u,
                            appsCounters: s,
                            memoryStorage: a,
                            publicRouterPrefix: c,
                            permittedPagesMap: f,
                            experiments: d,
                            isMobile: m
                        })
                    })), t = [].concat(N(), v, g), S = t
                }
            }

            function K(e) {
                var t = e.$w,
                    r = e.wixCodeApi,
                    n = e.parsedRoutersConfigs,
                    i = void 0 === n ? [] : n,
                    o = e.viewedUserRoles,
                    u = void 0 === o ? [] : o,
                    s = e.currentUser,
                    a = e.viewedUser,
                    c = e.appsCounters,
                    p = e.parsedConfigItems,
                    f = e.memoryStorage,
                    l = e.publicRouterPrefix,
                    d = e.permittedPagesMap,
                    m = void 0 === d ? {} : d,
                    v = e.experiments,
                    b = void 0 === v ? null : v,
                    w = e.isMobile,
                    x = t(g),
                    y = t(h);
                x.forEach((function(e) {
                    return T({
                        wixCodeApi: r,
                        menu: e,
                        parsedRoutersConfigs: i,
                        viewedUserRoles: u,
                        currentUser: s,
                        viewedUser: a,
                        appsCounters: c,
                        parsedConfigItems: p,
                        memoryStorage: f,
                        publicRouterPrefix: l,
                        permittedPagesMap: m,
                        experiments: b,
                        isMobile: w
                    })
                })), y.forEach((function(e) {
                    return T({
                        wixCodeApi: r,
                        menu: e,
                        parsedRoutersConfigs: i,
                        viewedUserRoles: u,
                        currentUser: s,
                        viewedUser: a,
                        appsCounters: c,
                        parsedConfigItems: p,
                        memoryStorage: f,
                        publicRouterPrefix: l,
                        permittedPagesMap: m,
                        experiments: b,
                        isMobile: w
                    })
                }))
            }
            var J = function(e, t, r) {
                    var n = function(e, t) {
                        var r = e.location,
                            n = r.prefix,
                            i = r.path,
                            o = t.find((function(e) {
                                return "public" === e.config.type
                            }));
                        return (null == o ? void 0 : o.prefix) === n ? "/" + n + "/{userName}/" + i.slice(1).join("/") : "/" + n + "/" + i.join("/")
                    }(t, r);
                    e(g).forEach((function(e) {
                        if (e.onChange) {
                            var t, r, i = null == (t = e.options) ? void 0 : t.find((function(e) {
                                return e.link === n
                            }));
                            e.value = null != (r = null == i ? void 0 : i.value) ? r : e.value
                        }
                    }))
                },
                G = r(945),
                $ = r.n(G),
                q = function() {
                    function e(e, t) {
                        this.httpClient = e, this.experiments = t, $()(this, "adminGroupId", "00000000-0000-0000-0000-000000000001"), $()(this, "restrictedPagesContext", "Pages"), $()(this, "permittedPagesExperiment", v)
                    }
                    var r = e.prototype;
                    return r.getPermittedPagesMap = function() {
                        var e = o()(s().mark((function e(t, r) {
                            var n, i, o, u, a;
                            return s().wrap((function(e) {
                                for (;;) switch (e.prev = e.next) {
                                    case 0:
                                        if (n = Object.values(t), this.shouldFetchPermittedPages(n, r)) {
                                            e.next = 3;
                                            break
                                        }
                                        return e.abrupt("return", {});
                                    case 3:
                                        return e.next = 5, this.fetchRestrictedPagesPermission();
                                    case 5:
                                        if (i = e.sent, this.hasRestrictedPages(i, n)) {
                                            e.next = 8;
                                            break
                                        }
                                        return e.abrupt("return", this.getPermittedPagesMapFallback(Object.keys(t), !0));
                                    case 8:
                                        return o = this.getNonRestrictedPages(i, n), u = this.getRestrictedMemberPages(i, n), e.next = 12, this.checkPermissionsForRestrictedPages(i.id, u);
                                    case 12:
                                        return a = e.sent, e.abrupt("return", this.toPermittedPagesMap(t, o, a));
                                    case 14:
                                    case "end":
                                        return e.stop()
                                }
                            }), e, this)
                        })));
                        return function(t, r) {
                            return e.apply(this, arguments)
                        }
                    }(), r.toPermittedPagesMap = function(e, r, n) {
                        return Object.entries(e).reduce((function(e, i) {
                            var o, u, s = i[0],
                                a = i[1];
                            return r.includes(a) ? t()({}, e, ((o = {})[s] = !0, o)) : t()({}, e, ((u = {})[s] = n[a], u))
                        }), {})
                    }, r.getRestrictedMemberPages = function(e, t) {
                        return e.resourceIds.filter((function(e) {
                            return t.includes(e)
                        }))
                    }, r.getNonRestrictedPages = function(e, t) {
                        return t.filter((function(t) {
                            return !e.resourceIds.includes(t)
                        }))
                    }, r.getPermittedPagesMapFallback = function(e, r) {
                        return e.reduce((function(e, n) {
                            var i;
                            return t()({}, e, ((i = {})[n] = r, i))
                        }), {})
                    }, r.checkPermissionsForRestrictedPages = function() {
                        var e = o()(s().mark((function e(t, r) {
                            var n, i, o, u, a;
                            return s().wrap((function(e) {
                                for (;;) switch (e.prev = e.next) {
                                    case 0:
                                        return i = "/_api/members-groups-web/v1/permissions/" + t, o = {
                                            params: {
                                                resourceId: r
                                            }
                                        }, u = this.getPermittedPagesMapFallback(r, !1), e.next = 5, null == (n = this.httpClient) ? void 0 : n.get(i, o).then((function(e) {
                                            return e.data.isPermitted
                                        })).catch((function() {
                                            return null
                                        }));
                                    case 5:
                                        return a = e.sent, e.abrupt("return", null != a ? a : u);
                                    case 7:
                                    case "end":
                                        return e.stop()
                                }
                            }), e, this)
                        })));
                        return function(t, r) {
                            return e.apply(this, arguments)
                        }
                    }(), r.fetchRestrictedPagesPermission = function() {
                        var e = o()(s().mark((function e() {
                            var t, r, n, i, o = this;
                            return s().wrap((function(e) {
                                for (;;) switch (e.prev = e.next) {
                                    case 0:
                                        return n = "/_api/members-groups-web/v1/groups/" + this.adminGroupId + "/permissions", e.next = 3, null == (t = this.httpClient) ? void 0 : t.get(n).then((function(e) {
                                            return e.data.permissions
                                        })).catch((function() {
                                            return null
                                        }));
                                    case 3:
                                        return i = e.sent, e.abrupt("return", null != (r = null == i ? void 0 : i.find((function(e) {
                                            var t = e.context;
                                            return o.restrictedPagesContext === t
                                        }))) ? r : null);
                                    case 5:
                                    case "end":
                                        return e.stop()
                                }
                            }), e, this)
                        })));
                        return function() {
                            return e.apply(this, arguments)
                        }
                    }(), r.hasRestrictedPages = function(e, t) {
                        return !(null == e || !e.resourceIds.length) && t.some((function(t) {
                            return e.resourceIds.includes(t)
                        }))
                    }, r.shouldFetchPermittedPages = function(e, t) {
                        var r, n = null == (r = this.experiments) ? void 0 : r.enabled(this.permittedPagesExperiment);
                        return null != n && n && e.length > 0 && "Site" === t
                    }, e
                }(),
                W = function() {
                    function e(e) {
                        this.storage = e
                    }
                    var t = e.prototype;
                    return t.hasCurrentUser = function(e) {
                        var t = this.getCurrentUserCacheKey(e);
                        return this.hasItemInStorage(t)
                    }, t.getCurrentUser = function(e) {
                        var t = this.getCurrentUserCacheKey(e);
                        return this.getItemFromStorage(t)
                    }, t.setCurrentUser = function(e, t) {
                        var r = this.getCurrentUserCacheKey(e);
                        return this.setItemToStorage(r, t)
                    }, t.hasViewedUser = function(e, t) {
                        var r = this.getViewedUserCacheKey(e, t);
                        return this.hasItemInStorage(r)
                    }, t.getViewedUser = function(e, t) {
                        var r = this.getViewedUserCacheKey(e, t);
                        return this.getItemFromStorage(r)
                    }, t.setViewedUser = function(e, t, r) {
                        var n = this.getViewedUserCacheKey(e, t);
                        return this.setItemToStorage(n, r)
                    }, t.hasRoles = function(e, t) {
                        var r = this.getRolesCacheKey(e, t);
                        return this.hasItemInStorage(r)
                    }, t.getRoles = function(e, t) {
                        var r = this.getRolesCacheKey(e, t);
                        return this.getItemFromStorage(r)
                    }, t.setRoles = function(e, t, r) {
                        var n = this.getRolesCacheKey(e, t);
                        return this.setItemToStorage(n, r)
                    }, t.hasNumbers = function(e, t) {
                        var r = this.getNumbersCacheKey(e, t);
                        return this.hasItemInStorage(r)
                    }, t.getNumbers = function(e, t) {
                        var r = this.getNumbersCacheKey(e, t);
                        return this.getItemFromStorage(r)
                    }, t.setNumbers = function(e, t, r) {
                        var n = this.getNumbersCacheKey(e, t);
                        return this.setItemToStorage(n, r)
                    }, t.hasItemInStorage = function(e) {
                        return !!this.storage.getItem(e)
                    }, t.getItemFromStorage = function(e) {
                        var t = this.storage.getItem(e);
                        return t ? JSON.parse(t) : null
                    }, t.setItemToStorage = function(e, t) {
                        return this.storage.setItem(e, JSON.stringify(t))
                    }, t.getCurrentUserCacheKey = function(e) {
                        return "cu-" + e
                    }, t.getViewedUserCacheKey = function(e, t) {
                        return "vu-" + t + "-" + e
                    }, t.getRolesCacheKey = function(e, t) {
                        return t ? "roles-" + t + "-" + e : "roles-" + e
                    }, t.getNumbersCacheKey = function(e, t) {
                        return "numbers-" + t + "-" + e
                    }, e
                }(),
                H = function() {
                    var e = o()(s().mark((function e(t) {
                        var r, n, i, o, u;
                        return s().wrap((function(e) {
                            for (;;) switch (e.prev = e.next) {
                                case 0:
                                    if (e.prev = 0, i = null == t || null == (r = t.essentials) ? void 0 : r.createExperiments, o = {
                                            scopes: ["members-area"]
                                        }, !(u = null != (n = null == i ? void 0 : i(o)) ? n : null)) {
                                        e.next = 7;
                                        break
                                    }
                                    return e.next = 7, u.ready();
                                case 7:
                                    return e.abrupt("return", u);
                                case 10:
                                    return e.prev = 10, e.t0 = e.catch(0), e.abrupt("return", null);
                                case 13:
                                case "end":
                                    return e.stop()
                            }
                        }), e, null, [
                            [0, 10]
                        ])
                    })));
                    return function(t) {
                        return e.apply(this, arguments)
                    }
                }();

            function Y(e) {
                var t, r = e.find((function(e) {
                    return "public" === JSON.parse(e.config).type
                }));
                if (r) {
                    var n = JSON.parse(r.config),
                        i = r.prefix,
                        o = Object.keys(null != (t = n.patterns) ? t : {}),
                        u = o.find((function(e) {
                            return !0 === n.patterns[e].socialHome
                        }));
                    if (u) return {
                        routerPrefix: i,
                        patternKey: u,
                        pageData: n.patterns[u]
                    };
                    if (o.length > 0) {
                        var s = o[0];
                        return {
                            routerPrefix: i,
                            patternKey: s,
                            pageData: n.patterns[s]
                        }
                    }
                }
            }
            var z, Q, X, Z, ee, te, re = function() {},
                ne = function() {
                    function e(e) {
                        var t = e.appRouters,
                            r = e.routerReturnedData,
                            n = e.wixCodeApi,
                            i = e.cacheService;
                        $()(this, "wixLocation", void 0), $()(this, "wixSite", void 0), $()(this, "isMobile", void 0), $()(this, "appRouters", void 0), $()(this, "routerReturnedData", void 0), $()(this, "wixCodeApi", void 0), $()(this, "cacheService", void 0), this.wixLocation = n.location, this.wixSite = n.site, this.isMobile = "Mobile" === n.window.formFactor, this.appRouters = t, this.routerReturnedData = r, this.wixCodeApi = n, this.cacheService = i
                    }
                    var r = e.prototype;
                    return r.matchRoute = function(e) {
                        var t = e.appDefinitionId,
                            r = e.sectionId,
                            n = e.onSuccess,
                            i = void 0 === n ? re : n,
                            o = e.onError,
                            u = void 0 === o ? re : o;
                        t && r || u("Error: please provide app ID and section ID for navigation");
                        var s = !1;
                        if (this.appRouters.forEach((function(e) {
                                if (!s) {
                                    var n = JSON.parse(e.config);
                                    return n.patterns && Object.keys(n.patterns).forEach((function(o) {
                                        if (!s) {
                                            var u = n.patterns[o];
                                            u.appData && u.appData.appDefinitionId === t && u.appData.appPageId === r && (s = !0, i(e.prefix, o))
                                        }
                                    }))
                                }
                            })), !s) {
                            var a = (this.wixSite.getSiteStructure().pages || []).filter((function(e) {
                                return e.applicationId === t && !e.prefix
                            })).pop();
                            return a ? (s = !0, i("", a.url)) : u("Error: can not resolve route for app " + t + " and page " + r)
                        }
                    }, r.getRouterOptions = function(e) {
                        var r = (e.appRouters || []).map((function(e) {
                                return t()({}, e, {
                                    config: JSON.parse(e.config)
                                })
                            })),
                            n = r.map((function(e) {
                                return e.config
                            }));
                        return {
                            publicRouterPrefix: r.find((function(e) {
                                return "public" === e.config.type
                            })).prefix,
                            parsedRoutersConfigs: n
                        }
                    }, r.getMenuRenderOptions = function(e) {
                        var r = e.config,
                            n = e.userService,
                            i = e.appsCounters,
                            o = e.enablePreview,
                            u = r.$w,
                            s = r.appParams,
                            c = this.getRouterOptions(s),
                            p = c.parsedRoutersConfigs,
                            f = c.publicRouterPrefix,
                            l = n.getViewedUser();
                        return {
                            $w: u,
                            wixCodeApi: this.wixCodeApi,
                            publicRouterPrefix: f,
                            parsedRoutersConfigs: p,
                            appsCounters: i,
                            memoryStorage: C(),
                            parsedConfigItems: a(r.config),
                            currentUser: n.getCurrentUser(),
                            viewedUser: o ? t()({}, l, {
                                id: "00000000-0000-0000-0000-000000000000"
                            }) : l,
                            viewedUserRoles: n.getRoles()[l.id] || [],
                            isMobile: this.isMobile
                        }
                    }, r.hasSocialApp = function(e) {
                        var t = e.applicationId;
                        return m.indexOf(t) > -1
                    }, r.hasSocialPages = function(e, t) {
                        var r = this;
                        return new Promise((function(n, i) {
                            if (!r.appRouters) return t && t("App routers not initialised"), i("App routers not initialised");
                            var o = r.appRouters.filter((function(e) {
                                    var t = JSON.parse(e.config);
                                    return "public" === t.type && t.patterns && Object.keys(t.patterns).length > 0
                                })),
                                u = r.wixSite.getSiteStructure().pages.filter(r.hasSocialApp);
                            e && e(o.length > 0 || u.length > 0), n(o.length > 0 || u.length > 0)
                        }))
                    }, r.getViewedUser = function(e, t) {
                        var r = this;
                        return new Promise((function(n, i) {
                            var o, u = null == (o = r.routerReturnedData) ? void 0 : o.memberData.memberContactId;
                            u ? (e && e(u), n(u)) : (t && t("Error getting viewed user"), i("Error getting viewed user"))
                        }))
                    }, r.navigateToSection = function(e, t) {
                        var r = this,
                            n = e.appDefinitionId,
                            i = e.sectionId,
                            o = e.tpaInnerRoute,
                            u = void 0 === o ? "" : o,
                            s = e.memberId,
                            a = void 0 === s ? "" : s;
                        return new Promise((function(e, o) {
                            r.matchRoute({
                                appDefinitionId: n,
                                sectionId: i,
                                onSuccess: function(t, n) {
                                    t && 0 !== t.indexOf("/") && (t = "/" + t), u && "/" !== u.charAt(0) && (u = "/" + u), r.wixLocation.to("" + t + (a ? n.replace(l, a) : n) + u), e()
                                },
                                onError: function(e) {
                                    t && t(e), o(e)
                                }
                            })
                        }))
                    }, r.getSectionUrl = function(e, t) {
                        var r = this,
                            n = e.appDefinitionId,
                            i = e.sectionId,
                            o = e.memberId,
                            u = void 0 === o ? "" : o,
                            s = e.memberSlug;
                        return new Promise((function(e, o) {
                            var a = s || u;
                            r.matchRoute({
                                appDefinitionId: n,
                                sectionId: i,
                                onSuccess: function(n, i) {
                                    n && 0 === n.indexOf("/") && (n = n.substring(1)), n || 0 !== i.indexOf("/") || (i = i.substring(1));
                                    var o = r.wixLocation.baseUrl;
                                    "/" !== o.slice(-1) && (o += "/");
                                    var u = Object.keys(r.wixLocation.query).map((function(e) {
                                        return e + "=" + r.wixLocation.query[e]
                                    })).join("&");
                                    t && t("" + o + n + (a ? i.replace(l, a) : i) + (u ? "?" + u : "")), e("" + o + n + (a ? i.replace(l, a) : i) + (u ? "?" + u : ""))
                                },
                                onError: function() {
                                    console.error("Route not found for app", n, "and section", i), t && t(r.wixLocation.url), o(r.wixLocation.url)
                                }
                            })
                        }))
                    }, r.getNavigatableRoles = function() {
                        var e = Y(this.appRouters);
                        if (e) {
                            var t, r, n = null != (t = null == (r = e.pageData.appData) ? void 0 : r.visibleForRoles) ? t : [];
                            return Promise.resolve({
                                navigatableMembersRoles: n,
                                isNavigationAllowed: !0
                            })
                        }
                        return Promise.resolve({
                            navigatableMembersRoles: [],
                            isNavigationAllowed: !1
                        })
                    }, r.navigateToMember = function(e, t) {
                        var r = this,
                            n = e.memberId,
                            i = e.memberSlug;
                        return new Promise((function(e, o) {
                            var u = i || n;
                            if (!n) return t && t("Error: please provide site member ID"), o("Error: please provide site member ID");
                            var s = Y(r.appRouters);
                            if (s) {
                                var a = "/" + s.routerPrefix + s.patternKey.replace(l, u);
                                r.wixLocation.to(a)
                            }
                            e()
                        }))
                    }, r.getMemberPagePrefix = function(e, t, r) {
                        var n = this,
                            i = e.type,
                            o = void 0 === i ? "public" : i;
                        return new Promise((function(e, i) {
                            if (!n.appRouters) return r && r("Can not get prefix for type " + o + " - no routers"), i("Can not get prefix for type " + o + " - no routers");
                            var u = n.appRouters.filter((function(e) {
                                return JSON.parse(e.config).type === o
                            })).pop();
                            if (!u) return r && r("Can not get prefix for type " + o), i("Can not get prefix for type " + o);
                            t && t({
                                type: o,
                                prefix: u.prefix
                            }), e({
                                type: o,
                                prefix: u.prefix
                            })
                        }))
                    }, r.setNotificationCount = function(e) {
                        N().forEach((function(r) {
                            var n;
                            null != (n = r.navBarItems) && n.length && (r.navBarItems = [t()({}, r.navBarItems[0], {
                                displayCount: e
                            })])
                        }))
                    }, r.enterPublicProfilePreviewMode = function(e) {
                        var t, r, n = this,
                            i = e.config,
                            o = e.userService,
                            u = i.appParams,
                            s = o.getViewedUser(),
                            a = null == (t = this.wixCodeApi) || null == (r = t.site) ? void 0 : r.getAppToken(u.appDefinitionId);
                        return Promise.resolve().then((function() {
                            return n.cacheService.hasNumbers(a, s.id) ? n.cacheService.getNumbers(a, s.id) : o.fetchMenuCounters(s, a)
                        })).then((function(e) {
                            var t = n.getMenuRenderOptions({
                                config: i,
                                userService: o,
                                appsCounters: e,
                                enablePreview: !0
                            });
                            w("renderMembersMenuItems", (function() {
                                return K(t)
                            }))()
                        }))
                    }, r.leavePublicProfilePreviewMode = function(e) {
                        var t, r, n = this,
                            i = e.config,
                            o = e.userService,
                            u = i.appParams,
                            s = o.getViewedUser(),
                            a = null == (t = this.wixCodeApi) || null == (r = t.site) ? void 0 : r.getAppToken(u.appDefinitionId);
                        return Promise.resolve().then((function() {
                            return n.cacheService.hasNumbers(a, s.id) ? n.cacheService.getNumbers(a, s.id) : o.fetchMenuCounters(s, a)
                        })).then((function(e) {
                            var t = n.getMenuRenderOptions({
                                config: i,
                                userService: o,
                                appsCounters: e,
                                enablePreview: !1
                            });
                            w("renderMembersMenuItems", (function() {
                                return K(t)
                            }))()
                        }))
                    }, r.clearMenus = function(e) {
                        var t = e.config;
                        return Promise.resolve().then((function() {
                            return e = null == t ? void 0 : t.$w, r = e(g), n = e(h), r.forEach((function(e) {
                                e.items = []
                            })), void n.forEach((function(e) {
                                e.items = []
                            }));
                            var e, r, n
                        }))
                    }, e
                }(),
                ie = function(e, t, r) {
                    var n = e.appDefinitionId,
                        i = e.routerReturnedData,
                        o = e.appRouters,
                        u = void 0 === o ? [] : o,
                        s = t.storage;
                    if (Z = M(r), te = function(e) {
                            return new W(e.memory)
                        }(s), X = new ne({
                            appRouters: u,
                            routerReturnedData: i,
                            wixCodeApi: r,
                            cacheService: te
                        }), function(e) {
                            b = e
                        }(s.memory), !i) return Promise.resolve();
                    var a = r.site.getAppToken(n),
                        c = i.memberData && i.memberData.slugs || [],
                        p = i.memberData && i.memberData.memberContactId || i.userId,
                        f = c.find((function(e) {
                            return !0 === e.primary
                        })),
                        l = {
                            id: p,
                            slug: f && f.name || p
                        };
                    return Z.setViewedUser(l), Z.setRoles(i.roles || {}), i.roles && te.setRoles(a, p, i.roles), Promise.resolve()
                },
                oe = function() {
                    var e = o()(s().mark((function e(t, r, n) {
                        var i, u, a, c, p, f, l, d;
                        return s().wrap((function(e) {
                            for (;;) switch (e.prev = e.next) {
                                case 0:
                                    if (!r) {
                                        e.next = 2;
                                        break
                                    }
                                    return e.abrupt("return", {
                                        currentUserCounters: void 0,
                                        viewedUserCounters: void 0
                                    });
                                case 2:
                                    return i = Z.getCurrentUser(), u = Z.getViewedUser(), a = function() {
                                        var e = o()(s().mark((function e(r) {
                                            var i;
                                            return s().wrap((function(e) {
                                                for (;;) switch (e.prev = e.next) {
                                                    case 0:
                                                        if (!te.hasNumbers(t, r.id)) {
                                                            e.next = 2;
                                                            break
                                                        }
                                                        return e.abrupt("return", te.getNumbers(t, r.id));
                                                    case 2:
                                                        return e.next = 4, Z.fetchMenuCounters(r, n);
                                                    case 4:
                                                        return i = e.sent, te.setNumbers(t, r.id, i), e.abrupt("return", i);
                                                    case 7:
                                                    case "end":
                                                        return e.stop()
                                                }
                                            }), e)
                                        })));
                                        return function(t) {
                                            return e.apply(this, arguments)
                                        }
                                    }(), c = u.id === i.id, p = a(i), e.next = 9, Promise.all([p, c ? p : u.id ? a(u) : {}]);
                                case 9:
                                    return f = e.sent, l = f[0], d = f[1], e.abrupt("return", {
                                        currentUserCounters: l,
                                        viewedUserCounters: d
                                    });
                                case 13:
                                case "end":
                                    return e.stop()
                            }
                        }), e)
                    })));
                    return function(t, r, n) {
                        return e.apply(this, arguments)
                    }
                }(),
                ue = function() {
                    var e = o()(s().mark((function e(t, r) {
                        var n, i, o;
                        return s().wrap((function(e) {
                            for (;;) switch (e.prev = e.next) {
                                case 0:
                                    if (n = Z.getCurrentUser(), i = Z.getViewedUser(), !te.hasRoles(t, null == i ? void 0 : i.id)) {
                                        e.next = 4;
                                        break
                                    }
                                    return e.abrupt("return", te.getRoles(t, null == i ? void 0 : i.id));
                                case 4:
                                    return e.next = 6, Z.fetchRoles(i.id, n.id, r);
                                case 6:
                                    return o = e.sent, te.setRoles(t, null == i ? void 0 : i.id, o), e.abrupt("return", o);
                                case 9:
                                case "end":
                                    return e.stop()
                            }
                        }), e)
                    })));
                    return function(t, r) {
                        return e.apply(this, arguments)
                    }
                }();
            var se = function(e) {
                    return function() {
                        var r = e.wixCodeApi,
                            n = P(e);
                        z = e;
                        var i = function(i) {
                            return void 0 === i && (i = r.user.currentUser), Z.setCurrentUser(i, n).then((function() {
                                return function(e) {
                                    var r, n, i = e.wixCodeApi,
                                        o = e.appParams,
                                        u = e.$w,
                                        s = Z.getViewedUser(),
                                        c = Z.getCurrentUser(),
                                        p = Z.getRoles(),
                                        f = P(e),
                                        l = c.loggedIn && 0 === Object.keys(p).length,
                                        d = i.site.getAppToken(o.appDefinitionId),
                                        m = "backend" === i.window.rendering.env,
                                        v = (o.appRouters || []).map((function(e) {
                                            return t()({}, e, {
                                                config: JSON.parse(e.config)
                                            })
                                        })),
                                        g = v.map((function(e) {
                                            return e.config
                                        }));
                                    return Promise.all([oe(d, m, f), l ? ue(d, f) : {}, ee.getPermittedPagesMap((r = v, n = {}, r.forEach((function(e) {
                                        var t;
                                        Object.entries(null != (t = e.pages) ? t : {}).forEach((function(e) {
                                            var t = e[0],
                                                r = e[1];
                                            n[t] = r
                                        }))
                                    })), n), i.window.viewMode)]).then((function(t) {
                                        var r, n = t[0],
                                            o = n.currentUserCounters,
                                            p = n.viewedUserCounters,
                                            f = t[1],
                                            d = t[2];
                                        l && Z.setRoles(f);
                                        var m = a(e.config),
                                            h = C(),
                                            b = "Mobile" === i.window.formFactor,
                                            x = Z.getRoles()[c.id] || [],
                                            y = Z.getRoles()[s.id] || [],
                                            R = v.find((function(e) {
                                                return "public" === e.config.type
                                            })),
                                            P = null != (r = null == R ? void 0 : R.prefix) ? r : "";
                                        w("renderMembersMenuItems", (function() {
                                            return K({
                                                $w: u,
                                                wixCodeApi: i,
                                                parsedRoutersConfigs: g,
                                                viewedUserRoles: y,
                                                viewedUser: s,
                                                currentUser: c,
                                                appsCounters: p,
                                                parsedConfigItems: m,
                                                memoryStorage: h,
                                                publicRouterPrefix: P,
                                                permittedPagesMap: d,
                                                experiments: Q,
                                                isMobile: b
                                            })
                                        }))(), w("renderLoginMenuItems", (function() {
                                            return B({
                                                $w: u,
                                                parsedRoutersConfigs: g,
                                                currentUserRoles: x,
                                                currentUser: c,
                                                appsCounters: o,
                                                memoryStorage: h,
                                                publicRouterPrefix: P,
                                                permittedPagesMap: d,
                                                experiments: Q,
                                                isMobile: b
                                            })
                                        }))()
                                    }))
                                }(e)
                            }))
                        };
                        return r.user.onLogin((function(e) {
                            return w("onLogin", (function() {
                                return i(e)
                            }))()
                        })), H(e).then((function(e) {
                            ee = function(e, t) {
                                return new q(e, t)
                            }(n, Q = e)
                        })).then((function() {
                            return i()
                        })).then((function() {
                            return function(e) {
                                var t = Z.getViewedUser();
                                if ("Site" === e.wixCodeApi.window.viewMode) {
                                    var r = k(e.wixCodeApi),
                                        n = Z.replaceUserPatternWithSlug(r, t);
                                    r !== n && (x("Deprecation check: redirect", {
                                        tags: {
                                            viewerName: e.platformAPIs.bi.viewerName
                                        },
                                        extra: {
                                            from: r,
                                            to: n
                                        }
                                    }), e.wixCodeApi.location.to(n))
                                }
                            }(e)
                        }))
                    }
                },
                ae = function(e) {
                    return e.map((function(e) {
                        var r, n, i, u;
                        return {
                            pageReady: "Editor" === e.wixCodeApi.window.viewMode ? (n = (r = e).$w, i = r.wixCodeApi, u = r.appParams, o()(s().mark((function e() {
                                var r, o, a;
                                return s().wrap((function(e) {
                                    for (;;) switch (e.prev = e.next) {
                                        case 0:
                                            o = "Mobile" === i.window.formFactor, a = (null != (r = u.appRouters) ? r : []).map((function(e) {
                                                return t()({}, e, {
                                                    config: JSON.parse(e.config)
                                                })
                                            })), o && J(n, i, a);
                                        case 3:
                                        case "end":
                                            return e.stop()
                                    }
                                }), e)
                            })))) : se(e),
                            exports: {}
                        }
                    }))
                },
                ce = function(e, t, r, n) {
                    return function(e, t) {
                        (c = t.monitoring.createMonitor("https://fe0974951f45411fbe57fbbd7c30bbf2@sentry.wixpress.com/28")) && c.setUserContext({
                            msid: t.bi.metaSiteId
                        }), p = t.fedOpsLoggerFactory.getLoggerForWidget({
                            appName: "santa-members-viewer-app",
                            appId: e.appDefinitionId
                        })
                    }(e, n), w("initAppForPage", (function() {
                        return ie(e, t, r)
                    }))()
                },
                pe = function(e) {
                    return w("createControllers", (function() {
                        return ae(e)
                    }))()
                },
                fe = {
                    hasSocialPages: function(e, t) {
                        return w("publicApi.hasSocialPages", (function() {
                            return X.hasSocialPages(e, t)
                        }))()
                    },
                    getViewedUser: function(e, t) {
                        return w("publicApi.getViewedUser", (function() {
                            return X.getViewedUser(e, t)
                        }))()
                    },
                    navigateToSection: function(e, t) {
                        return w("publicApi.navigateToSection", (function() {
                            return X.navigateToSection(e, t)
                        }))()
                    },
                    navigateToMember: function(e, t) {
                        return w("publicApi.navigateToMember", (function() {
                            return X.navigateToMember(e, t)
                        }))()
                    },
                    getNavigatableRoles: function(e) {
                        return w("publicApi.getNavigatableRoles", (function() {
                            return X.getNavigatableRoles()
                        }))()
                    },
                    getSectionUrl: function(e, t) {
                        return w("publicApi.getSectionUrl", (function() {
                            return X.getSectionUrl(e, t)
                        }))()
                    },
                    getMemberPagePrefix: function(e, t, r) {
                        return w("publicApi.getMemberPagePrefix ", (function() {
                            return X.getMemberPagePrefix(e, t, r)
                        }))()
                    },
                    setNotificationCount: function(e) {
                        return w("publicApi.setNotificationCount", (function() {
                            return X.setNotificationCount(e)
                        }))()
                    },
                    enterPublicProfilePreviewMode: function() {
                        return w("publicApi.enterPublicProfilePreviewMode", (function() {
                            return X.enterPublicProfilePreviewMode({
                                userService: Z,
                                config: z
                            })
                        }))()
                    },
                    leavePublicProfilePreviewMode: function() {
                        return w("publicApi.leavePublicProfilePreviewMode", (function() {
                            return X.leavePublicProfilePreviewMode({
                                userService: Z,
                                config: z
                            })
                        }))()
                    },
                    clearMenus: function() {
                        return w("publicApi.clearMenus", (function() {
                            return X.clearMenus({
                                config: z
                            })
                        }))()
                    }
                }
        }(), n
    }()
}));
//# sourceMappingURL=app.bundle.min.js.map