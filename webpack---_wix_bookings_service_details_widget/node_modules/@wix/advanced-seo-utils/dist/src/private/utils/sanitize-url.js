"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.sanitizeUrl = void 0;
var consts_1 = require("../consts/consts");
/**
 * Sanitizes the given URL by leaving only supported query params.
 *
 * @param {String} url to sanitize
 */
function sanitizeUrl(url) {
    if (typeof url === 'string') {
        var queryIndex = url.indexOf(consts_1.QUERY_SEPARATOR);
        if (queryIndex !== -1) {
            var _a = url.split(consts_1.QUERY_SEPARATOR),
                urlWithoutQuery = _a[0],
                query = _a[1];
            var sanitizedQuery = query
                .split(consts_1.QUERY_PARAM_SEPARATOR)
                .filter(function(pair) {
                    return consts_1.QUERY_WHITELIST.some(function(key) {
                        return pair.startsWith(key);
                    });
                })
                .join(consts_1.QUERY_PARAM_SEPARATOR);
            if (sanitizedQuery) {
                return "" + urlWithoutQuery + consts_1.QUERY_SEPARATOR + sanitizedQuery;
            }
            return urlWithoutQuery;
        }
        return url;
    }
    return undefined;
}
exports.sanitizeUrl = sanitizeUrl;