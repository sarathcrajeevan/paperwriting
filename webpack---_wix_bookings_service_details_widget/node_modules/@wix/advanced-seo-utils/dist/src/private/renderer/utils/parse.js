"use strict";
var __importDefault = (this && this.__importDefault) || function(mod) {
    return (mod && mod.__esModule) ? mod : {
        "default": mod
    };
};
Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.parse = void 0;
var html_parser_1 = __importDefault(require("../../utils/html-parser"));
/**
 * Parses a given HTML fragment and returns them as tags.
 *
 * @param {string} html fragment to parse.
 */
function parse(html) {
    if (typeof html !== 'string') {
        return [];
    }
    var tags = [];
    try {
        var currentIndex_1 = 0;
        html_parser_1.default(html, {
            start: function(type, attr) {
                var tag = {
                    type: type
                };
                if (attr.length) {
                    tag.props = extractProps(attr);
                }
                tags.push(tag);
                currentIndex_1 = tags.length - 1;
            },
            chars: function(children) {
                if (tags[currentIndex_1] && tags[currentIndex_1].type && children) {
                    tags[currentIndex_1].children = children;
                }
            },
        });
    } catch (e) {}
    return tags;
}
exports.parse = parse;

function extractProps(attrs) {
    return (attrs || []).reduce(function(acc, curr) {
        acc[curr.name] = curr.value;
        return acc;
    }, {});
}