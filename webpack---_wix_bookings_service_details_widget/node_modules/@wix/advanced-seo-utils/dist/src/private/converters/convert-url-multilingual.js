"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.convertUrlMultilingual = void 0;
var consts_1 = require("../consts/consts");
/**
 * Sanitizes the given URL by leaving only supported query params.
 *
 * @param {String} url original url
 * @param {String} lang value to add to url
 */
function convertUrlMultilingual(_a) {
    var urlString = _a.urlString,
        lang = _a.lang,
        _b = _a.connectedDomainResponse,
        isConnected = _b.isConnected,
        missingDomianInfo = _b.hasError;
    try {
        var url_1 = new URL(urlString);
        if (missingDomianInfo) {
            isConnected = consts_1.WIX_DOMAINLESS_IDS.every(function(domainId) {
                return !url_1.hostname.includes(domainId);
            });
        }
        return isConnected ?
            handleUrlWithDomain(url_1, lang) :
            handleUrlWithNoDomain(url_1, lang);
    } catch (_c) {
        return typeof urlString === 'string' ? urlString : '';
    }
}
exports.convertUrlMultilingual = convertUrlMultilingual;

function handleUrlWithNoDomain(url, lang) {
    url.searchParams.set('lang', lang);
    return url.href;
}

function handleUrlWithDomain(url, lang) {
    var protocol = url.protocol,
        host = url.host,
        pathname = url.pathname,
        search = url.search,
        href = url.href;
    return host.includes('www') ?
        href.replace('www', lang) :
        protocol + "//" + lang + "." + host + pathname + search;
}